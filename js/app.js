function plainDownload(){let o=$("#plain-download-form input[name='postUrl']").val();plainDownloadFormValidate(o)&&(o=matchPurePostUrl(o),$("#plain-download-form input[name='postUrl']").val(o),$("#plain_download_submit").attr("disabled",!0),$("#plain-download-container").empty(),$("#plain-download-container").LoadingOverlay("show"),$.post("/plainDownload",{postUrl:o},function(o){if($("#plain-download-container").LoadingOverlay("hide"),$("#plain_download_submit").attr("disabled",!1),"1"!=o.code)return void $("#plain-download-container").html(buildMessage(localizeResultMessage(o)));let a="",e=[];$.each(o.result,function(o,t){let n;if("2"==t.mediaType){n=t.mediaName.split(".")[0];let o=`/mediaDisplay/${t.shortMediaName}?mhu=${t.mediaHashUrl}&mt=2&eht=${t.urlExpireHashTime}`;e.push({videoId:n,videoDisplayURL:o})}let l={1:`<img class="img-thumbnail img-fluid" src="/mediaDisplay/${t.shortMediaName}?mhu=${t.mediaHashUrl}&mt=1&eht=${t.urlExpireHashTime}">`,2:`<video id="${n}" class="img-thumbnail img-fluid" controls poster="/mediaDisplay/${t.shortPosterName}?mhu=${t.posterHashUrl}&mt=1&eht=${t.urlExpireHashTime}"></video>`}[t.mediaType];a+={1:`<div class="col-md-12 offset-md-0 mt-2">${l}<a href="/mediaDisplay/${t.shortMediaName}?mhu=${t.mediaHashUrl}&mt=1&eht=${t.urlExpireHashTime}" class="btn material-icons download-button" target="_blank" role="button">file_download</a></div>`,2:`<div class="col-md-12 offset-md-0 mt-2">${l}<button onclick="downloadVideo('${t.shortMediaName}', '${t.mediaHashUrl}')" class="btn material-icons download-button">file_download</button></div>`}[t.mediaType]}),$("#plain-download-container").html(a),$("#plain-download-container").append(feedAds),$("#plain-download-form input[name='postUrl']").val(""),e.forEach(function(o,a){fetch(o.videoDisplayURL,{method:"GET",responseType:"blob"}).then(o=>o.blob()).then(a=>{$("#"+o.videoId).attr("src",URL.createObjectURL(a))})})}))}function plainDownloadFormValidate(o){if(isEmptyString(o))return $("#plain-download-container").empty(),$("#plain-download-container").html(buildMessage(infoMap[lang][0])),!1;return!!new RegExp("^https://(|www.)instagram.com/.*$").test(o)||($("#plain-download-container").empty(),$("#plain-download-container").html(buildMessage(infoMap[lang][1])),!1)}function storyDownload(){let o=$("#story-download-form input[name='userName']").val();storyDownloadFormValidate(o)&&(o=matchUserName(o),$("#story-download-form input[name='userName']").val(o),$("#story_download_submit").attr("disabled",!0),$("#story-download-container").empty(),$("#story-download-container").LoadingOverlay("show"),$.post("/storyDownload",{userName:o},function(o){if($("#story-download-container").LoadingOverlay("hide"),$("#story_download_submit").attr("disabled",!1),"1"!=o.code)return void $("#story-download-container").html(buildMessage(localizeResultMessage(o)));let a="",e=[];$.each(o.result,function(o,t){let n;if("2"==t.mediaType){n=t.mediaName.split(".")[0];let o=`/mediaDisplay/${t.shortMediaName}?mhu=${t.mediaHashUrl}&mt=2&eht=${t.urlExpireHashTime}`;e.push({videoId:n,videoDisplayURL:o})}let l=new Date(1e3*t.storyExpireTime).Format("yyyy-MM-dd HH:mm:ss"),i={1:`<img class="img-thumbnail img-fluid" src="/mediaDisplay/${t.shortMediaName}?mhu=${t.mediaHashUrl}&mt=1&eht=${t.urlExpireHashTime}">`,2:`<video id="${n}" class="img-thumbnail img-fluid" controls poster="/mediaDisplay/${t.shortPosterName}?mhu=${t.posterHashUrl}&mt=1&eht=${t.urlExpireHashTime}"></video>`}[t.mediaType];a+={1:`<div class="col-md-12 offset-md-0 mt-2">${i}<span class="expire-info text-black font-weight-bold"><span class="material-icons inline-block" style="vertical-align: middle;">schedule</span>${l}</span><a href="/mediaDisplay/${t.shortMediaName}?mhu=${t.mediaHashUrl}&mt=1&eht=${t.urlExpireHashTime}" class="btn text-black material-icons download-button" target="_blank" role="button">file_download</a></div>`,2:`<div class="col-md-12 offset-md-0 mt-2">${i}<span class="expire-info text-black font-weight-bold"><span class="material-icons inline-block" style="vertical-align: middle;">schedule</span>${l}</span><button onclick="downloadVideo('${t.shortMediaName}', '${t.mediaHashUrl}')" class="btn text-black material-icons download-button">file_download</button></div>`}[t.mediaType]}),$("#story-download-container").html(a),$("#story-download-container").append(feedAds),$("#story-download-form input[name='userName']").val(""),e.forEach(function(o,a){fetch(o.videoDisplayURL,{method:"GET",responseType:"blob"}).then(o=>o.blob()).then(a=>{$("#"+o.videoId).attr("src",URL.createObjectURL(a))})})}))}function storyDownloadFormValidate(o){return!isEmptyString(o)||($("#story-download-container").empty(),$("#story-download-container").html(buildMessage(infoMap[lang][2])),!1)}function highlightDownload(){let o=$("#highlight-download-form input[name='highlightUrl']").val();highlightDownloadFormValidate(o)&&($("#highlight_download_submit").attr("disabled",!0),$("#highlight-download-container").empty(),$("#highlight-download-container").LoadingOverlay("show"),$.post("/highlightDownload",{highlightUrl:o},function(o){if($("#highlight-download-container").LoadingOverlay("hide"),$("#highlight_download_submit").attr("disabled",!1),"1"!=o.code)return void $("#highlight-download-container").html(buildMessage(localizeResultMessage(o)));let a="",e=[];$.each(o.result,function(o,t){let n;if("2"===t.mediaType){n=t.mediaName.split(".")[0];let o=`/mediaDisplay/${t.shortMediaName}?mhu=${t.mediaHashUrl}&mt=2&eht=${t.urlExpireHashTime}`;e.push({videoId:n,videoDisplayURL:o})}let l={1:`<img class="img-thumbnail img-fluid" src="/mediaDisplay/${t.shortMediaName}?mhu=${t.mediaHashUrl}&mt=1&eht=${t.urlExpireHashTime}">`,2:`<video id="${n}" class="img-thumbnail img-fluid" controls poster="/mediaDisplay/${t.shortPosterName}?mhu=${t.posterHashUrl}&mt=1&eht=${t.urlExpireHashTime}"></video>`}[t.mediaType];a+={1:`<div class="col-md-12 offset-md-0 mt-2">${l}<a href="/mediaDisplay/${t.shortMediaName}?mhu=${t.mediaHashUrl}&mt=1&eht=${t.urlExpireHashTime}" class="btn material-icons download-button" target="_blank" role="button">file_download</a></div>`,2:`<div class="col-md-12 offset-md-0 mt-2">${l}<button onclick="downloadVideo('${t.shortMediaName}', '${t.mediaHashUrl}')" class="btn material-icons download-button">file_download</button></div>`}[t.mediaType]}),$("#highlight-download-container").html(a),$("#highlight-download-container").append(feedAds),$("#highlight-download-form input[name='highlightUrl']").val(""),e.forEach(function(o,a){fetch(o.videoDisplayURL,{method:"GET",responseType:"blob"}).then(o=>o.blob()).then(a=>{$("#"+o.videoId).attr("src",URL.createObjectURL(a))})})}))}function highlightDownloadFormValidate(o){if(isEmptyString(o))return $("#highlight-download-container").empty(),$("#highlight-download-container").html(buildMessage(infoMap[lang][10])),!1;let a=new RegExp("^https://www.instagram.com/stories/highlights/.*$"),e=new RegExp("^https://www.instagram.com/s/.*?story_media_id=.*$");return!(!a.test(o)&&!e.test(o))||($("#highlight-download-container").empty(),$("#highlight-download-container").html(buildMessage(infoMap[lang][11])),!1)}function profileDownload(){let o=$("#profile-download-form input[name='userName']").val();profileDownloadFormValidate(o)&&(o=matchUserName(o),$("#profile-download-form input[name='userName']").val(o),$("#profile_download_submit").attr("disabled",!0),$("#profile-download-container").empty(),$("#profile-download-container").LoadingOverlay("show"),$.post("/profileDownload",{userName:o},function(o){if($("#profile-download-container").LoadingOverlay("hide"),$("#profile_download_submit").attr("disabled",!1),"1"!==o.code)return void $("#profile-download-container").html(buildMessage(localizeResultMessage(o)));let a=o.result,e=`<div class="col-md-12 offset-md-0 mt-2">${`<img class="img-thumbnail img-fluid" src="/mediaDisplay/${a.shortMediaName}?mhu=${a.mediaHashUrl}&mt=1&eht=${a.urlExpireHashTime}">`}<a href="/mediaDisplay/${a.shortMediaName}?mhu=${a.mediaHashUrl}&mt=1&eht=${a.urlExpireHashTime}" class="btn material-icons download-button" target="_blank" role="button">file_download</a></div>`;$("#profile-download-container").html(e),$("#profile-download-container").append(feedAds),$("#profile-download-form input[name='userName']").val("")}))}function profileDownloadFormValidate(o){return!isEmptyString(o)||($("#profile-download-container").empty(),$("#profile-download-container").html(buildMessage(infoMap[lang][2])),!1)}function followersDownload(){let o=$("#followers-download-form input[name='userName']").val(),a=$("#followers-download-form input[name='redeemCode']").val();followersDownloadFormValidate(o,a)&&(o=matchUserName(o),$("#followers-download-form input[name='userName']").val(o),$("#followers_download_submit").attr("disabled",!0),$("#followers-download-container").empty(),$("#followers-download-container").html(buildMessage(infoMap[lang][5])),$(".loading-overlay-container").LoadingOverlay("show"),$.post("/followersDownload",{userName:o,redeemCode:a},function(o){$(".loading-overlay-container").LoadingOverlay("hide"),$("#followers_download_submit").attr("disabled",!1),"1"==o.code?($("#followers-download-container").html(buildMessage(`<span class="text-info font-weight-bold">${o.result.downloadName}<button class="btn material-icons" onclick="followersDownloadText('${o.result.downloadName}', '${o.result.downloadKey}')" role="button">cloud_download</button></span>`)),$("#followers-download-form input[name='userName']").val(""),$("#followers-download-form input[name='redeemCode']").val("")):$("#followers-download-container").html(buildMessage(localizeResultMessage(o)))}))}function followersDownloadText(o,a){$(".loading-overlay-container").LoadingOverlay("show"),$.fileDownload("/textDownload",{httpMethod:"GET",data:{downloadName:o,downloadKey:a},prepareCallback:function(o){$("#followers-download-container").html(buildMessage(infoMap[lang][6]))},abortCallback:function(o){$("#followers-download-container").html(buildMessage(infoMap[lang][7])),$(".loading-overlay-container").LoadingOverlay("hide")},successCallback:function(o){$("#followers-download-container").html(buildMessage(infoMap[lang][8])),$(".loading-overlay-container").LoadingOverlay("hide")},failCallback:function(o,a){let e=$.parseJSON($(o).text());$("#followers-download-container").html(buildMessage(localizeResultMessage(e))),$(".loading-overlay-container").LoadingOverlay("hide")}})}function followersDownloadFormValidate(o,a){return isEmptyString(o)?($("#followers-download-container").empty(),$("#followers-download-container").html(buildMessage(infoMap[lang][2])),!1):!isEmptyString(a)||($("#followers-download-container").empty(),$("#followers-download-container").html(buildMessage(infoMap[lang][12])),!1)}function batchDownloadPro(){let o=$("#batch-download-pro-form input[name='userName']").val(),a=$("#batch-download-pro-form input[name='redeemCode']").val();batchDownloadProFormValidate(o,a)&&(o=matchUserName(o),$("#batch-download-pro-form input[name='userName']").val(o),$("#batch_download_pro_submit").attr("disabled",!0),$("#batch-download-pro-container").empty(),$("#batch-download-pro-container").html(buildMessage(infoMap[lang][5])),$(".loading-overlay-container").LoadingOverlay("show"),$.post("/batchDownloadPro",{userName:o,redeemCode:a},function(o){$(".loading-overlay-container").LoadingOverlay("hide"),$("#batch_download_pro_submit").attr("disabled",!1),"1"==o.code?($("#batch-download-pro-container").html(buildMessage(`<span class="text-info font-weight-bold">${o.result.downloadName}<button class="btn material-icons" onclick="batchDownloadProZip('${o.result.downloadName}', '${o.result.fileID}')" role="button">cloud_download</button></span>`)),$("#batch-download-pro-form input[name='userName']").val(""),$("#batch-download-pro-form input[name='redeemCode']").val("")):$("#batch-download-pro-container").html(buildMessage(localizeResultMessage(o)))}))}function batchDownloadProZip(o,a){$(".loading-overlay-container").LoadingOverlay("show"),$.fileDownload("/zipDownload",{httpMethod:"GET",data:{downloadName:o,fileID:a},prepareCallback:function(o){$("#batch-download-pro-container").html(buildMessage(infoMap[lang][6]))},abortCallback:function(o){$("#batch-download-pro-container").html(buildMessage(infoMap[lang][7])),$(".loading-overlay-container").LoadingOverlay("hide")},successCallback:function(o){$("#batch-download-pro-container").html(buildMessage(infoMap[lang][8])),$(".loading-overlay-container").LoadingOverlay("hide")},failCallback:function(o,a){let e=$.parseJSON($(o).text());$("#batch-download-pro-container").html(buildMessage(e.message)),$(".loading-overlay-container").LoadingOverlay("hide")}})}function batchDownloadProFormValidate(o,a){return isEmptyString(o)?($("#batch-download-pro-container").empty(),$("#batch-download-pro-container").html(buildMessage(infoMap[lang][2])),!1):!isEmptyString(a)||($("#batch-download-pro-container").empty(),$("#batch-download-pro-container").html(buildMessage(infoMap[lang][12])),!1)}function downloadVideo(o,a){$("body").LoadingOverlay("show"),fetch("/videoDownload",{headers:{"content-type":"application/json"},method:"POST",body:JSON.stringify({downloadName:o,mediaHashUrl:a})}).then(o=>o.blob()).then(a=>{const e=window.navigator.userAgent;(!!e.match(/iPad/i)||!!e.match(/iPhone/i))&&$("#videoDownloadPromptModal").modal("show"),download(a,o,"application/octet-stream"),$("body").LoadingOverlay("hide")}).catch(o=>{$("body").LoadingOverlay("hide"),alert(o)})}function isEmptyString(o){return!o||""===o||null==o||0===o.trim().length}function localizeResultMessage(o){if(o.code in codeMap)return codeMap[o.code][lang];let a=infoMap.en.indexOf(o.message);return-1===a?o.message:infoMap[lang][a]}function buildMessage(o){return`<div class="col-md-12 offset-md-0 mt-2"><div class="alert alert-warning alert-dismissible fade show loading-overlay-container" role="alert">\n\t\t<button type="button" class="close" data-dismiss="alert" aria-label="Close">\n\t\t\t<span aria-hidden="true">×</span>\n\t\t</button>\n\t\t<p class="text-left">${o}</p>\n\t</div></div>`}function matchPurePostUrl(o){/https:\/\/instagram.com\/(.*?)/.test(o)&&(o=o.replace("instagram.com","www.instagram.com"));const a=/(.*?)(\?|$)/.exec(o);return a&&a[1]?a[1].trim():o}function matchUserName(o){o=o.trim();if(/https:\/\/.*instagram.com\/stories\/(.*?)/.test(o)){const a=/https:\/\/.*instagram.com\/stories\/(.*?)(\/|\?|$)/.exec(o);return a&&a[1]?a[1].trim():o}if(/https:\/\/.*instagram.com\/(.*?)/.test(o)){const a=/https:\/\/.*instagram.com\/(.*?)(\/|\?|$)/.exec(o);return a&&a[1]?a[1].trim():o}return o}infoMap={en:["Post url cannot be blank.","Post url is invalid.","Username ID cannot be blank.","Please select download mode.","User cookie cannot be blank","Processing... please wait about 1-3 minutes.","File is downloading...","File download terminated abnormally.","File downloaded successfully.","Username ID is invalid.","Story highlights url cannot be blank.","Story highlights url is invalid.","Redeem code cannot be blank."],cn:["帖子链接不能为空。","帖子链接无效。","用户名ID不能为空。","请选择下载模式。","用户cookie不能为空。","正在处理...请等待1-3分钟。","文件正在下载中...","文件下载异常终止。","文件下载成功。","用户名ID无效。","快拍精选链接不能为空。","快拍精选链接无效。","兑换码不能为空。"],hk:["貼文鏈接不能為空。","貼文鏈接無效。","用戶名ID不能為空。","請選擇下載模式。","用戶cookie不能為空。","正在處理...請等待1-3分鐘。","文件正在下載中...","文件下載異常終止。","文件下載成功。","用戶名ID無效。","限時動態精選鏈接不能為空。","限時動態精選鏈接無效。","兌換碼不能為空。"],jp:["投稿のURLを空白にすることはできません。","投稿URLが無効です。","ユーザー名IDを空白にすることはできません。","ダウンロードモードを選択してください。","ユーザーCookieを空白にすることはできません","処理中... 1〜3分ほどお待ちください。","ファイルをダウンロードしています...","ファイルのダウンロードが異常終了しました。","ファイルが正常にダウンロードされました。","ユーザー名IDが無効です。","ストーリーのハイライトURLを空白にすることはできません。","ストーリーのハイライトURLが無効です。","引き換えコードを空白にすることはできません。"]},codeMap={408:{en:"Request timed out, please try again.",cn:"请求超时，再试一次。",hk:"請求超時，再試一次。",jp:"リクエストがタイムアウトしました。もう一度お試しください。"},429:{en:"Request too frequent, please try again in a few minutes.",cn:"请求太频繁，请等待几分钟后重试。",hk:"請求太頻繁，請等待幾分鐘後重試。",jp:"リクエストが多すぎます。数分後にもう一度お試しください。"},42901:{en:"Operation has reached the limit, please try again in a few hours.",cn:"操作次数已达上限，请等待数小时后重试。",hk:"操作次數已達上限，請等待數小時後重試。",jp:"操作が制限に達しました。数時間後に再試行してください。"},42902:{en:"This Feature is temporarily unavailable, please try again later.",cn:"该功能暂不可用，请稍后重试。",hk:"該功能暫不可用，請稍後重試。",jp:"この機能は一時的に利用できません。しばらくしてからもう一度お試しください。"},10000:{en:"Error downloading url.",cn:"下载链接时出错。",hk:"下載鏈接時出錯。",jp:"URLのダウンロード中にエラーが発生しました。"},10001:{en:"Error downloading file.",cn:"下载文件时出错。",hk:"下載文件時出錯。",jp:"ファイルのダウンロード中にエラーが発生しました。"},10002:{en:"Error generating zip.",cn:"生成压缩包时出错。",hk:"生成壓縮包時出錯。",jp:"zipの生成中にエラーが発生しました。"},40001:{en:"Url is invalid or not supported yet.",cn:"链接无效或尚不支持。",hk:"鏈接無效或尚不支持。",jp:"URLが無効であるか、まだサポートされていません。"},40002:{en:"Username ID does not exist.",cn:"用户名ID不存在。",hk:"用戶名ID不存在。",jp:"ユーザー名IDが存在しません。"},40003:{en:"User has not posted content or account is private.",cn:"用户尚未发布内容或帐户未公开。",hk:"用戶尚未發佈內容或帳戶未公開。",jp:"ユーザーがコンテンツを投稿していないか、アカウントが非公開です。"},40004:{en:"Invalid username ID or cookie.",cn:"用户名ID或Cookie无效。",hk:"用戶名ID或Cookie無效。",jp:"ユーザー名IDまたはCookieが無効です。"},40006:{en:"User has not posted Instagram Story or has expired.",cn:"用户尚未发布快拍(Instagram Story)或已过期。",hk:"用戶尚未發布限時動態(Instagram Story)或已過期。",jp:"ユーザーがInstagramストーリーを投稿していないか、有効期限が切れています。"},40008:{en:"Story highlights does not exist.",cn:"快拍精选内容不存在。",hk:"限時動態精選內容不存在。",jp:"ストーリーのハイライトは存在しません。"},40009:{en:"Redeem code is invalid.",cn:"兑换码无效。",hk:"兌換碼無效。",jp:"無効な引き換えコード"}},optionMap=["plain-download","story-download","highlight-download","profile-download"],feedAds='<div class="col-md-12 offset-md-0 mt-2">\n\t\t\t\t<ins class="adsbygoogle"\n\t\t\t     style="display:block"\n\t\t\t     data-ad-client="ca-pub-6232783881632642"\n\t\t\t     data-ad-slot="2883708977"\n\t\t\t     data-ad-format="rectangle"\n\t\t\t     data-full-width-responsive="false"></ins>\n\t\t\t\t<script>\n\t\t\t     (adsbygoogle = window.adsbygoogle || []).push({});\n\t\t\t\t<\/script>\n\t\t\t</div>',$(document).ready(function(){let o,a=new URLSearchParams(new URL(window.location.href).search);if(a.has("ot")&&$.inArray(o=a.get("ot"),optionMap)>-1){$(".dropdown-menu a[class*='active']").removeClass("active");const a=$(".dropdown-menu a").filter(`[tab-id='${o}']`).addClass("active");$("#default-option").html(a.html()),$(".tab-content div[class*='active']").removeClass("active").addClass("fade"),$(".tab-content div").filter(`[id='${o}']`).removeClass("fade").addClass("active")}/Edge\/\d./i.test(navigator.userAgent)&&$(".material-icons.download-item-icon").remove(),$("h1").click(function(){$(location).prop("href",`https://instaer.app/${lang}`)}),$(".dropdown-menu a").on("click",function(){$(".dropdown-toggle").html($(this).html());let o=$(this).attr("tab-id");$(".tab-pane").removeClass("active"),$("#"+o).tab("show"),$(".dropdown-item").removeClass("active"),$("a[tab-id='"+o+"']").addClass("active")}),$("form input").on("keypress",function(o){return 13!==o.which}),$("#plain_download_submit").on("click",function(o){plainDownload()}),$("#story_download_submit").on("click",function(o){storyDownload()}),$("#highlight_download_submit").on("click",function(o){highlightDownload()}),$("#profile_download_submit").on("click",function(o){profileDownload()}),$("#followers_download_submit").on("click",function(o){followersDownload()}),$("#batch_download_pro_submit").on("click",function(o){batchDownloadPro()})}),Date.prototype.Format=function(o){const a={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"H+":this.getHours()%12==0?12:this.getHours()%12,"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(o)&&(o=o.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in a)new RegExp("("+e+")").test(o)&&(o=o.replace(RegExp.$1,1===RegExp.$1.length?a[e]:("00"+a[e]).substr((""+a[e]).length)));return o};